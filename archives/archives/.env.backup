# ============================================================================
# PipeLineServices Configuration
# Shared environment variables for Ingestion and Retrieval pipelines
# ============================================================================

# ============================================================================
# Environment Configuration
# ============================================================================
# Set to "development" for local development, "production" for server
# This controls service URLs and connection settings
ENVIRONMENT=development

# ============================================================================
# Inter-Service Communication
# ============================================================================
INTERNAL_MODE=true

# ============================================================================
# Nebius AI Studio Configuration
# ============================================================================
NEBIUS_API_KEY=eyJhbGciOiJIUzI1NiIsImtpZCI6IlV6SXJWd1h0dnprLVRvdzlLZWstc0M1akptWXBvX1VaVkxUZlpnMDRlOFUiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnb29nbGUtb2F1dGgyfDEwNDg1MDE1NzgwMDYwNDQwNDIxOCIsInNjb3BlIjoib3BlbmlkIG9mZmxpbmVfYWNjZXNzIiwiaXNzIjoiYXBpX2tleV9pc3N1ZXIiLCJhdWQiOlsiaHR0cHM6Ly9uZWJpdXMtaW5mZXJlbmNlLmV1LmF1dGgwLmNvbS9hcGkvdjIvIl0sImV4cCI6MTkxNzI2MTA0NywidXVpZCI6IjAxOTlhZjM0LTBjZmMtNzdkNi1hNjQ3LTMwYTg2YWUxYzY3YiIsIm5hbWUiOiJDcmF3bEVuZ2luZVBybyIsImV4cGlyZXNfYXQiOiIyMDMwLTEwLTAzVDEyOjMwOjQ3KzAwMDAifQ.M9LRHA4M-9H6oUimGqVdB88KGCFZUtQOhkYYha3vw9U
NEBIUS_API_URL=https://api.studio.nebius.ai/v1/embeddings

# ============================================================================
# LLM Gateway Configuration (Port 8065)
# ============================================================================
# LLM Gateway runs on port 8065 (part of Ingestion services 8060-8069)
# Development: Local instance on port 8065
# Production: Local instance on port 8065
LLM_GATEWAY_URL_DEVELOPMENT=http://localhost:8065
LLM_GATEWAY_URL_PRODUCTION=http://localhost:8065
LLM_GATEWAY_API_KEY=internal_service_2025_secret_key_metadata_embeddings
LLM_GATEWAY_SERVICE_PORT=8065

# ============================================================================
# Milvus Vector Database Configuration (Environment-aware)
# ============================================================================
# Development: Access via SSH tunnel (ssh -i ~/reku631_nebius -L 19530:localhost:19530 reku631@89.169.108.8)
#              Milvus runs on production server, accessed via tunnel on localhost:19530
# Production: Direct localhost access (Milvus runs locally on server)
MILVUS_HOST_DEVELOPMENT=localhost
MILVUS_PORT_DEVELOPMENT=19530
MILVUS_HOST_PRODUCTION=localhost
MILVUS_PORT_PRODUCTION=19530
MILVUS_USER=
MILVUS_PASSWORD=

# SSH Tunnel Configuration (for documentation - manual setup required)
# Development requires SSH tunnel: ssh -i ~/reku631_nebius -L 19530:localhost:19530 -L 3000:localhost:3000 reku631@89.169.108.8
# This tunnels both Milvus (19530) and Attu UI (3000) from production server to local machine

# ============================================================================
# Ingestion Pipeline Service Ports (8060-8069)
# ============================================================================
INGESTION_API_PORT=8060           # Main orchestrator API (public)
CHUNKING_SERVICE_PORT=8061        # Internal only
METADATA_SERVICE_PORT=8062        # Internal only
EMBEDDINGS_SERVICE_PORT=8063      # Internal only
STORAGE_SERVICE_PORT=8064         # Internal only
LLM_GATEWAY_SERVICE_PORT=8065     # LLM Gateway (internal only)

# ============================================================================
# Ingestion Pipeline Service URLs (Internal Mode)
# ============================================================================
CHUNKING_SERVICE_URL=http://localhost:8061/v1/orchestrate
METADATA_SERVICE_URL=http://localhost:8062/v1/metadata
EMBEDDINGS_SERVICE_URL=http://localhost:8063/v1/embeddings
STORAGE_SERVICE_URL=http://localhost:8064/v1

# ============================================================================
# Retrieval Pipeline Service Ports (8070-8079)
# ============================================================================
RETRIEVAL_API_PORT=8070           # Main orchestrator API (public)
SEARCH_SERVICE_PORT=8071          # Internal only
RERANK_SERVICE_PORT=8072          # Internal only
COMPRESS_SERVICE_PORT=8073        # Internal only
ANSWER_SERVICE_PORT=8074          # Internal only

# ============================================================================
# Retrieval Pipeline Service URLs (Internal Mode)
# ============================================================================
SEARCH_SERVICE_URL=http://localhost:8071/v1
RERANK_SERVICE_URL=http://localhost:8072/v1
COMPRESS_SERVICE_URL=http://localhost:8073/v1
ANSWER_SERVICE_URL=http://localhost:8074/v1

# ============================================================================
# Performance Configuration
# ============================================================================
MAX_WORKERS=5
SERVICE_TIMEOUT=60

# Connection Pooling
CONNECTION_POOL_SIZE=20
CONNECTION_POOL_MAX=100
CONNECTION_TIMEOUT=60

# Batch Processing
BATCH_SIZE=32
MAX_BATCH_SIZE=128
MAX_CONCURRENT_REQUESTS=20
DEFAULT_TIMEOUT=30

# ============================================================================
# Caching Configuration
# ============================================================================
ENABLE_CACHING=true
CACHE_TTL=7200                    # 2 hours (7200 seconds)
CACHE_MAX_SIZE=10000              # 10000 entries

# ============================================================================
# APISIX Gateway Configuration (Legacy - Not Used in New Architecture)
# ============================================================================
APISIX_GATEWAY_URL=http://localhost:9080
APISIX_ADMIN_URL=http://localhost:9180
APISIX_ADMIN_KEY=sk-apisix-admin-mindmate247-2025-v2
SERVICE_API_KEY=sk-internal-service-key

# ============================================================================
# Host Configuration
# ============================================================================
HOST=0.0.0.0

JINA_AI_KEY=jina_a2e5ee1eea2d444d93e4cc954cecedd9jBBf9EAC3x0Avhynva0mbltZd-HzRERANKER_BACKEND=jina
